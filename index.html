<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XR Store</title>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ff0a0a 0%, #cc0000 50%, #ff0a0a 100%);
            color: #fff;
            min-height: 100vh;
        }

        nav {
            background: rgba(255, 10, 10, 0.95);
            padding: 1.2rem 5%;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
            border-bottom: 2px solid #fff;
        }

        nav .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo { 
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: #ffffff;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 900;
            color: #ff0a0a;
            box-shadow: 
                0 0 20px rgba(255, 10, 10, 0.6),
                0 4px 15px rgba(0, 0, 0, 0.3);
            transform: rotate(-5deg);
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
        }

        nav ul {
            display: flex;
            gap: 2.5rem;
            list-style: none;
            align-items: center;
        }

        nav a {
            color: #fff;
            text-decoration: none;
            font-weight: 500;
        }

        .btn-login, .btn-register, .btn-admin, .btn-logout {
            padding: 0.7rem 2rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            border: none;
            transition: 0.3s;
        }

        .btn-login {
            background: #fff;
            color: #ff0a0a;
        }

        .btn-register {
            background: transparent;
            border: 2px solid #fff;
        }

        .btn-admin {
            background: #fff;
            color: #ff0a0a;
            display: none;
        }

        .btn-logout {
            background: #e53935;
            display: none;
        }

        .hero {
            padding: 140px 5% 60px;
            text-align: center;
            background: linear-gradient(135deg, #ff1a1a 0%, #ff4444 100%);
        }

        .hero h1 {
            font-size: 2.4rem;
            margin-bottom: 1rem;
        }

        .categories {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem 5%;
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .category-btn {
            background: rgba(255,255,255,0.9);
            color: #ff0a0a;
            padding: 0.8rem 2rem;
            border-radius: 10px;
            border: 2px solid #fff;
            font-weight: 700;
            cursor: pointer;
            transition: 0.3s;
        }

        .category-btn.active {
            background: #fff;
            transform: scale(1.05);
        }

        .filter-section {
            max-width: 1400px;
            margin: 1rem auto 0;
            padding: 0 5%;
            display: none;
        }

        .filter-section.active {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .filter-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.5);
            color: #fff;
            padding: 0.6rem 1.5rem;
            border-radius: 8px;
        }

        .filter-btn.active {
            background: #fff;
            color: #ff0a0a;
        }

        .products {
            max-width: 1400px;
            margin: 0 auto;
            padding: 3rem 5%;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
        }

        .product-card {
            background: #242424;
            border-radius: 15px;
            border: 2px solid #333;
            overflow: hidden;
            transition: 0.3s;
        }

        .product-card:hover {
            transform: translateY(-5px);
            border-color: #ff0a0a;
        }

        .product-image {
            height: 220px;
            background: #1b1b1b;
            border-bottom: 3px solid #ff0a0a;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .product-logo {
            width: 70px;
            height: 70px;
            background: #fff;
            color: #ff0a0a;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            font-weight: 900;
            transform: rotate(-5deg);
            box-shadow: 0 6px 20px rgba(255,0,0,0.4);
        }

        .product-content {
            padding: 1.5rem;
        }

        .product-title {
            font-size: 1.3rem;
            margin-bottom: 0.3rem;
        }

        .product-description {
            color: #aaa;
            margin-bottom: 1rem;
        }

        .price {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .btn-buy {
            background: #ff0a0a;
            padding: 0.6rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            color: #fff;
            font-weight: 700;
            transition: 0.3s;
        }

        .btn-buy:hover {
            background: #ff4444;
        }

        footer {
            background: #ff0a0a;
            padding: 2rem 5%;
            text-align: center;
            margin-top: 3rem;
            color: #fff;
            border-top: 2px solid #fff;
        }
    </style>
</head>
<body>

    <nav>
        <div class="container">
            <div class="logo">
                <div class="logo-icon">XR</div>
                <span class="logo-text">XR Store</span>
            </div>

            <ul>
                <li><a href="#inicio">Inicio</a></li>
                <li><a href="#productos">Productos</a></li>
                <li><a href="#contacto">Contacto</a></li>

                <li><button class="btn-register" id="registerBtn">Registrarse</button></li>
                <li><button class="btn-login" id="loginBtn">Iniciar Sesión</button></li>
                <li><button class="btn-admin" id="adminBtn">Panel Admin</button></li>
                <li><button class="btn-logout" id="logoutBtn">Cerrar Sesión</button></li>
            </ul>
        </div>
    </nav>

    <section class="hero" id="inicio">
        <h1>Mapeos Premium para tu Servidor</h1>
        <p>Los mejores mapeos personalizados para MTA, FiveM y SAMP</p>
    </section>
    <section class="categories">
        <button class="category-btn active" data-category="all">Todos</button>
        <button class="category-btn" data-category="mta">MTA</button>
        <button class="category-btn" data-category="fivem">FiveM</button>
        <button class="category-btn" data-category="samp">SAMP</button>
        <button class="category-btn" data-category="anticheat">AntiCheat</button>
    </section>

    <section id="mtaFilters" class="filter-section">
        <button class="filter-btn active" data-filter="all">Todos</button>
        <button class="filter-btn" data-filter="scripts">Scripts</button>
        <button class="filter-btn" data-filter="mapeos">Mapeos</button>
    </section>

    <section id="fivemFilters" class="filter-section">
        <button class="filter-btn active" data-filter="all">Todos</button>
        <button class="filter-btn" data-filter="scripts">Scripts</button>
        <button class="filter-btn" data-filter="mapeos">Mapeos</button>
    </section>

    <section id="sampFilters" class="filter-section">
        <button class="filter-btn active" data-filter="all">Todos</button>
        <button class="filter-btn" data-filter="scripts">Scripts</button>
        <button class="filter-btn" data-filter="mapeos">Mapeos</button>
    </section>

    <section class="products" id="productos"></section>

    <footer id="contacto">
        <p>© 2024 XR Store. Todos los derechos reservados.</p>
    </footer>

    <!-- Modal Registro -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="closeRegister">&times;</span>
            <h2>Crear Cuenta</h2>

            <div class="success-message" id="registerSuccess"></div>
            <div class="error-message" id="registerError"></div>

            <form id="registerForm">
                <div class="form-group">
                    <label>Usuario</label>
                    <input type="text" id="regUsername" required minlength="3">
                </div>

                <div class="form-group">
                    <label>Contraseña</label>
                    <input type="password" id="regPassword" required minlength="6">
                </div>

                <div class="form-group">
                    <label>Confirmar Contraseña</label>
                    <input type="password" id="regConfirmPassword" required>
                </div>

                <button type="submit" class="btn-submit">Registrarse</button>
            </form>

            <div class="form-link">
                ¿Ya tienes cuenta? <a href="#" id="goToLogin">Inicia sesión</a>
            </div>
        </div>
    </div>

    <!-- Modal Login -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="closeLogin">&times;</span>
            <h2>Iniciar Sesión</h2>

            <div class="error-message" id="loginError"></div>

            <form id="loginForm">
                <div class="form-group">
                    <label>Usuario</label>
                    <input type="text" id="username">
                </div>

                <div class="form-group">
                    <label>Contraseña</label>
                    <input type="password" id="password">
                </div>

                <button type="submit" class="btn-submit">Entrar</button>
            </form>

            <div class="form-link">
                ¿No tienes cuenta? <a href="#" id="goToRegister">Regístrate</a>
            </div>
        </div>
    </div>

    <!-- Modal Admin -->
    <div id="adminModal" class="modal">
        <div class="modal-content admin-panel">
            <span class="close-modal" id="closeAdmin">&times;</span>
            <h2>Panel de Administración</h2>

            <div class="admin-tabs">
                <button class="admin-tab active" data-tab="users">Usuarios</button>
                <button class="admin-tab" data-tab="products">Productos</button>
                <button class="admin-tab" data-tab="addProduct">Agregar</button>
            </div>

            <!-- TAB USUARIOS -->
            <div id="usersTab" class="admin-section active">
                <h3 style="color:#fff;margin-bottom:10px;">Usuarios registrados</h3>
                <div id="usersList" class="user-list"></div>
            </div>

            <!-- TAB PRODUCTOS -->
            <div id="productsTab" class="admin-section">
                <h3 style="color:#fff;margin-bottom:10px;">Lista de productos</h3>
                <div id="productsList" class="product-list"></div>
            </div>

            <!-- TAB AGREGAR PRODUCTO -->
            <div id="addProductTab" class="admin-section">
                <h3 style="color:#fff;margin-bottom:10px;">Agregar producto</h3>

                <form id="addProductForm">

                    <div class="form-group">
                        <label>Título del Producto</label>
                        <input type="text" id="productTitle" required>
                    </div>

                    <div class="form-group">
                        <label>Descripción</label>
                        <textarea id="productDescription" required></textarea>
                    </div>

                    <div class="form-group">
                        <label>Precio</label>
                        <input type="text" id="productPrice" required>
                    </div>

                    <div class="form-group">
                        <label>URL Imagen</label>
                        <input type="url" id="productImage">
                    </div>

                    <div class="form-group">
                        <label>Categoría</label>
                        <select id="productCategory" required>
                            <option value="mta">MTA</option>
                            <option value="fivem">FiveM</option>
                            <option value="samp">SAMP</option>
                            <option value="anticheat">AntiCheat</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Tipo</label>
                        <select id="productType" required>
                            <option value="scripts">Scripts</option>
                            <option value="mapeos">Mapeos</option>
                            <option value="anticheat">AntiCheat</option>
                        </select>
                    </div>

                    <button type="submit" class="btn-submit">Agregar</button>

                </form>
            </div>

        </div>
    </div>

    <!-- Modal Editar Producto -->
    <div id="editProductModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="closeEditProduct">&times;</span>
            <h2>Editar Producto</h2>

            <form id="editProductForm">
                <input type="hidden" id="editProductIndex">

                <div class="form-group">
                    <label>Título del Producto</label>
                    <input type="text" id="editProductTitle" required>
                </div>

                <div class="form-group">
                    <label>Descripción</label>
                    <textarea id="editProductDescription" required></textarea>
                </div>

                <div class="form-group">
                    <label>Precio</label>
                    <input type="text" id="editProductPrice" required>
                </div>

                <div class="form-group">
                    <label>URL Imagen</label>
                    <input type="url" id="editProductImage">
                </div>

                <div class="form-group">
                    <label>Categoría</label>
                    <select id="editProductCategory" required>
                        <option value="mta">MTA</option>
                        <option value="fivem">FiveM</option>
                        <option value="samp">SAMP</option>
                        <option value="anticheat">AntiCheat</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Tipo</label>
                    <select id="editProductType" required>
                        <option value="scripts">Scripts</option>
                        <option value="mapeos">Mapeos</option>
                        <option value="anticheat">AntiCheat</option>
                    </select>
                </div>

                <button type="submit" class="btn-submit">Guardar Cambios</button>
            </form>
        </div>
    </div>
<script>
/* ------------------------------
    FUNCIONES DE ALMACENAMIENTO
--------------------------------*/
function saveToStorage(key, data) {
    localStorage.setItem(key, JSON.stringify(data));
}

function getFromStorage(key) {
    const data = localStorage.getItem(key);
    return data ? JSON.parse(data) : null;
}

/* ------------------------------
    INICIALIZACIÓN
--------------------------------*/
let users = getFromStorage('xrstore_users');
let products = getFromStorage('xrstore_products');
let currentUser = null;

if (!users) {
    users = [
        { username: "admin", password: "admin123", role: "admin" }
    ];
    saveToStorage("xrstore_users", users);
}

if (!products) {
    products = [
        { title: 'Sistema de Inventario', description: 'Sistema completo de inventario para MTA', price: '$16.00', category: 'mta', type: 'scripts', image: '' },
        { title: 'Sistema de Trabajos', description: 'Múltiples trabajos para roleplay MTA', price: '$20.00', category: 'mta', type: 'scripts', image: '' },

        { title: 'Apartamentos Modernos', description: 'Interiores editables', price: 'GRATIS', category: 'mta', type: 'mapeos', image: '' },
        { title: 'Tienditas Pack', description: 'Pack de tiendas', price: '$8.00', category: 'mta', type: 'mapeos', image: '' },

        { title: 'HUD Premium', description: 'HUD personalizado para FiveM', price: '$15.00', category: 'fivem', type: 'scripts', image: '' },
        { title: 'Sistema de Policía', description: 'Sistema completo de policía', price: '$25.00', category: 'fivem', type: 'scripts', image: '' },

        { title: 'Casa de Lujo', description: 'Interior moderno', price: '$14.00', category: 'fivem', type: 'mapeos', image: '' },

        { title: 'Sistema de Facciones', description: 'Sistema completo de facciones', price: '$19.00', category: 'samp', type: 'scripts', image: '' },

        { title: 'AntiCheat Pro', description: 'AntiCheat avanzado', price: '$30.00', category: 'anticheat', type: 'anticheat', image: '' }
    ];

    saveToStorage("xrstore_products", products);
}

/* ------------------------------
    SESIÓN GUARDADA
--------------------------------*/
let session = getFromStorage("xrstore_session");

if (session) {
    let found = users.find(u => u.username === session.username);
    if (found) {
        currentUser = found;
        updateUIForLoggedInUser();
    }
}

/* ------------------------------
    ACTUALIZACIÓN DE UI
--------------------------------*/
function updateUIForLoggedInUser() {
    document.getElementById("loginBtn").style.display = "none";
    document.getElementById("registerBtn").style.display = "none";

    document.getElementById("logoutBtn").style.display = "block";
    document.getElementById("logoutBtn").textContent = currentUser.username;

    if (currentUser.role === "admin") {
        document.getElementById("adminBtn").style.display = "block";
    }
}

function updateUIForLoggedOutUser() {
    document.getElementById("loginBtn").style.display = "block";
    document.getElementById("registerBtn").style.display = "block";
    document.getElementById("logoutBtn").style.display = "none";
    document.getElementById("adminBtn").style.display = "none";
}

/* ------------------------------
    RENDER PRODUCTOS
--------------------------------*/
let currentCategory = "all";
let currentFilter = "all";

function renderProducts() {
    const container = document.getElementById("productos");
    container.innerHTML = "";

    const filtered = products.filter(p => {
        const c = currentCategory === "all" || p.category === currentCategory;
        const f = currentFilter === "all" || p.type === currentFilter;
        return c && f;
    });

    filtered.forEach(product => {
        const card = document.createElement("div");
        card.className = "product-card";

        const img = product.image.trim() !== ''
            ? `<div class="product-image"><img src="${product.image}" /></div>`
            : `<div class="product-image"><div class="product-logo">XR</div></div>`;

        card.innerHTML = `
            ${img}
            <div class="product-content">
                <h3 class="product-title">${product.title}</h3>
                <p class="product-description">${product.description}</p>
                <div class="product-footer">
                    <span class="price">${product.price}</span>
                    <button class="btn-buy">${product.price === "GRATIS" ? "Descargar" : "Comprar"}</button>
                </div>
            </div>
        `;

        container.appendChild(card);
    });
}

renderProducts();

/* ------------------------------
    LOGIN FUNCIONAL
--------------------------------*/
document.getElementById("loginForm").onsubmit = function(e) {
    e.preventDefault();

    let username = document.getElementById("username").value.trim();
    let password = document.getElementById("password").value;

    const user = users.find(u => u.username === username && u.password === password);

    if (!user) {
        document.getElementById("loginError").textContent = "Usuario o contraseña incorrectos";
        document.getElementById("loginError").style.display = "block";
        return;
    }

    currentUser = user;
    saveToStorage("xrstore_session", { username: user.username });

    updateUIForLoggedInUser();
    document.getElementById("loginModal").style.display = "none";
};

/* ------------------------------
    REGISTRO
--------------------------------*/
document.getElementById("registerForm").onsubmit = function(e) {
    e.preventDefault();

    let username = document.getElementById("regUsername").value.trim();
    let password = document.getElementById("regPassword").value;
    let confirm = document.getElementById("regConfirmPassword").value;

    const error = document.getElementById("registerError");
    const success = document.getElementById("registerSuccess");

    error.style.display = "none";
    success.style.display = "none";

    if (password !== confirm) {
        error.textContent = "Las contraseñas no coinciden";
        error.style.display = "block";
        return;
    }

    if (users.some(u => u.username === username)) {
        error.textContent = "El usuario ya existe";
        error.style.display = "block";
        return;
    }

    users.push({ username, password, role: "user" });
    saveToStorage("xrstore_users", users);

    success.textContent = "Cuenta creada correctamente";
    success.style.display = "block";

    setTimeout(() => {
        registerModal.style.display = "none";
        loginModal.style.display = "block";
    }, 1500);
};

/* ------------------------------
    LOGOUT
--------------------------------*/
document.getElementById("logoutBtn").onclick = () => {
    localStorage.removeItem("xrstore_session");
    currentUser = null;
    updateUIForLoggedOutUser();
};

/* ------------------------------
    ABRIR PANEL ADMIN
--------------------------------*/
document.getElementById("adminBtn").onclick = () => {
    loadUsersList();
    loadProductsList();
    adminModal.style.display = "block";
};

/* ------------------------------
    LISTA DE USUARIOS
--------------------------------*/
function loadUsersList() {
    const container = document.getElementById("usersList");
    container.innerHTML = "";

    users.forEach((user, index) => {
        let div = document.createElement("div");
        div.className = "user-item";

        div.innerHTML = `
            <strong>${user.username}</strong>
            <span class="user-role" 
                style="padding:5px;background:${user.role==='admin'?'#ff0a0a':'#888'};">
                ${user.role.toUpperCase()}
            </span>
        `;

        let actions = document.createElement("div");

        if (currentUser.role === "admin" && currentUser.username !== user.username) {
            
            if (user.role === "user") {
                let promote = document.createElement("button");
                promote.textContent = "Hacer Admin";
                promote.onclick = () => {
                    users[index].role = "admin";
                    saveToStorage("xrstore_users", users);
                    loadUsersList();
                };
                actions.appendChild(promote);
            }

            if (user.role === "admin") {
                let demote = document.createElement("button");
                demote.textContent = "Quitar Admin";
                demote.onclick = () => {
                    users[index].role = "user";
                    saveToStorage("xrstore_users", users);
                    loadUsersList();
                };
                actions.appendChild(demote);
            }

            let del = document.createElement("button");
            del.textContent = "Eliminar";
            del.onclick = () => {
                if (confirm("¿Eliminar usuario?")) {
                    users.splice(index, 1);
                    saveToStorage("xrstore_users", users);
                    loadUsersList();
                }
            };
            actions.appendChild(del);
        }

        div.appendChild(actions);
        container.appendChild(div);
    });
}

/* ------------------------------
    LISTA DE PRODUCTOS (ADMIN)
--------------------------------*/
function loadProductsList() {
    const container = document.getElementById("productsList");
    container.innerHTML = "";

    products.forEach((p, index) => {
        const item = document.createElement("div");
        item.className = "product-item";

        item.innerHTML = `
            <strong>${p.title}</strong>
            <p>${p.description}</p>
            <p style="color:#ff0a0a">${p.price}</p>
        `;

        let actions = document.createElement("div");

        let edit = document.createElement("button");
        edit.textContent = "Editar";
        edit.onclick = () => openEditProductModal(index);

        let del = document.createElement("button");
        del.textContent = "Eliminar";
        del.onclick = () => {
            if (confirm("¿Eliminar producto?")) {
                products.splice(index, 1);
                saveToStorage("xrstore_products", products);
                loadProductsList();
                renderProducts();
            }
        };

        actions.appendChild(edit);
        actions.appendChild(del);

        item.appendChild(actions);
        container.appendChild(item);
    });
}

/* ------------------------------
    ABRIR MODAL EDITAR
--------------------------------*/
function openEditProductModal(index) {
    const p = products[index];

    document.getElementById("editProductIndex").value = index;
    document.getElementById("editProductTitle").value = p.title;
    document.getElementById("editProductDescription").value = p.description;
    document.getElementById("editProductPrice").value = p.price;
    document.getElementById("editProductImage").value = p.image;
    document.getElementById("editProductCategory").value = p.category;
    document.getElementById("editProductType").value = p.type;

    editProductModal.style.display = "block";
}

/* ------------------------------
    GUARDAR PRODUCTO EDITADO
--------------------------------*/
document.getElementById("editProductForm").onsubmit = function(e) {
    e.preventDefault();

    let index = parseInt(document.getElementById("editProductIndex").value);

    products[index] = {
        title: document.getElementById("editProductTitle").value,
        description: document.getElementById("editProductDescription").value,
        price: document.getElementById("editProductPrice").value,
        image: document.getElementById("editProductImage").value,
        category: document.getElementById("editProductCategory").value,
        type: document.getElementById("editProductType").value
    };

    saveToStorage("xrstore_products", products);

    editProductModal.style.display = "none";

    loadProductsList();
    renderProducts();
};

/* ------------------------------
    AGREGAR PRODUCTO
--------------------------------*/
document.getElementById("addProductForm").onsubmit = function(e) {
    e.preventDefault();

    let newProduct = {
        title: document.getElementById("productTitle").value,
        description: document.getElementById("productDescription").value,
        price: document.getElementById("productPrice").value,
        image: document.getElementById("productImage").value,
        category: document.getElementById("productCategory").value,
        type: document.getElementById("productType").value
    };

    products.push(newProduct);
    saveToStorage("xrstore_products", products);

    loadProductsList();
    renderProducts();

    alert("Producto agregado con éxito");
};

/* ------------------------------
    MODALES
--------------------------------*/
document.getElementById("loginBtn").onclick = () => loginModal.style.display = "block";
document.getElementById("registerBtn").onclick = () => registerModal.style.display = "block";
document.getElementById("closeLogin").onclick = () => loginModal.style.display = "none";
document.getElementById("closeRegister").onclick = () => registerModal.style.display = "none";
document.getElementById("closeAdmin").onclick = () => adminModal.style.display = "none";
document.getElementById("closeEditProduct").onclick = () => editProductModal.style.display = "none";

document.getElementById("goToLogin").onclick = function(e) {
    e.preventDefault();
    registerModal.style.display = "none";
    loginModal.style.display = "block";
};

document.getElementById("goToRegister").onclick = function(e) {
    e.preventDefault();
    loginModal.style.display = "none";
    registerModal.style.display = "block";
};

window.onclick = function(event) {
    if (event.target === loginModal) loginModal.style.display = "none";
    if (event.target === registerModal) registerModal.style.display = "none";
    if (event.target === adminModal) adminModal.style.display = "none";
    if (event.target === editProductModal) editProductModal.style.display = "none";
};
</script>

</body>
</html>
